{"version":3,"sources":["frontend/base/default/ebanx/js/document.js"],"names":["defaultLabel","taxVatLabel","countrySelect","country","toLowerCase","getLabelByCountry","join","toUpperCase","EBANXData","OSCRequire","ebanxRemoveOSCRequireDocument","changeTaxVatLabel","value","newLabel","setTimeout","placeholder","taxVatInput","inputHandler","$documentTypeSelect","document","removeDocumentTypeField","getElementById","addDocumentTypeField","createElement","div","ul","insertBefore","closest","className","innerHTML","amsCheckoutHandler","querySelector","addEventListener","dispatchEvent","Event","init"],"mappings":"aAGA,IAAAA,aAAA,KAGIC,YAAc,KADdD,YAAAA,KACAC,cAAc,KAEdC,kBAAJ,SAAAC,EAAAH,GAGE,OAAQG,EAAQC,eADZC,IAAAA,KACJ,OAAQF,UAAQC,4BAAhBE,KAAA,OAAAC,cACE,IAAK,KACH,MAAOC,MACT,IAAK,KACH,MAAO,MACT,IAAK,KACH,MAAO,WACT,QACE,OAAOR,IATbS,WAAA,SAAAN,GAgB+C,oBAAlCO,+BADPD,8BAAAA,IAANE,kBAAA,WAOE,IAAMR,EAAUD,cAAcU,MAD1BD,EAAAA,kBAAAA,EAAAA,cAEJF,WAAMI,GAENJ,WAGE,WADFK,YACEC,YAAW,IADb,IAQAd,YAAIE,UAAoBA,EAEpB,OADFW,GACQ,OAANX,GAAM,OAAAA,GAAA,OAAAA,GACJa,WAFJ,WAMDA,YAAAD,YAAAF,GAEDI,IAIAA,aAAMC,YAAsBC,IAG3BC,wBAAA,WAHD,IAAMF,EAAsBC,SAASE,eAAe,uBAKpD,OAAAH,cAAAA,OAAAA,GAAA,OAAAA,GAIAA,EAAkBN,UADdU,qBAAuB,WAK3B,GAAqBC,OAAfC,cAAML,QAAuBA,SAAnCE,eAAA,+BAAA,CAgBAI,IAAGC,EAAAA,SAAkBV,cAAYW,MArBnCH,EAAAI,UAAA,SAOEJ,EAAIK,UAAJ,slBA6BE5B,YAAc6B,QAAAA,MACfJ,aAAAF,EAAAR,YAAAW,QAAA,SAGC3B,KAAAA,WAfFC,YAAakB,SAASY,cAAc,iCAiBlC7B,YAAAA,SAAc8B,eAAiB,kBAC/B9B,cAAc8B,SAAAA,cAAiB,0BAE/B9B,UAAAA,YAA4BD,aAAUe,aAAtC,OAAAA,eAIJG,uBAdOlB,aAA6C,mBAAvB6B,qBACzB7B,YAAc6B,sBAGZ5B,gBACFF,aAAeC,YAAY4B,UAE3B3B,cAAc8B,iBAAiB,SAAUrB,mBACzCT,cAAc8B,iBAAiB,SAAUV,sBACzCpB,cAAc8B,iBAAiB,SAAUZ,yBACzClB,cAAc+B,cAAc,IAAIC,MAAM,cAI1Cf,SAASa,iBAAiB,mBAAoBG","file":"document.js","sourcesContent":["/* global EBANXData */\n/* global amsCheckoutHandler */\n/* global ebanxRemoveOSCRequireDocument */\n/* global inputHandler */\n\nlet defaultLabel = null;\nlet taxVatLabel = null;\nlet taxVatInput = null;\nlet countrySelect = null;\n\nconst getLabelByCountry = (country, defaultLabel) => {\n  switch (country.toLowerCase()) {\n    case 'br':\n      return EBANXData.brazilAllowedDocumentFields.join(' / ').toUpperCase();\n    case 'co':\n      return 'DNI';\n    case 'cl':\n      return 'RUT';\n    case 'ar':\n      return 'Document';\n    default:\n      return defaultLabel;\n  }\n};\n\nconst OSCRequire = country => {\n  if (typeof ebanxRemoveOSCRequireDocument !== 'undefined') {\n    ebanxRemoveOSCRequireDocument(country);\n  }\n};\n\nconst changeTaxVatLabel = () => {\n  const country = countrySelect.value;\n  const newLabel = getLabelByCountry(country, defaultLabel);\n\n  OSCRequire(country);\n\n  setTimeout(\n    function() {\n      taxVatInput.placeholder = '';\n    },\n    10\n  );\n\n  taxVatLabel.innerHTML = newLabel;\n  if (country === 'BR' || country === 'CO' || country === 'CL' || country === 'AR') {\n    setTimeout(\n      () => {\n        taxVatInput.placeholder = newLabel;\n      },\n      10\n    );\n  }\n\n  inputHandler(taxVatInput, country);\n};\n\nconst removeDocumentTypeField = () => {\n  const $documentTypeSelect = document.getElementById('ebanx-document-type');\n  if (countrySelect.value === 'AR' || !$documentTypeSelect || $documentTypeSelect === null) {\n    return;\n  }\n\n  $documentTypeSelect.remove();\n};\n\nconst addDocumentTypeField = () => {\n  if (countrySelect.value !== 'AR' || document.getElementById('billing:ebanx_document_type')) {\n    return;\n  }\n\n  const div = document.createElement('li');\n  div.className = 'fields';\n  div.innerHTML = `<div id=\"ebanx-document-type\" class=\"field\">\n      <label for=\"billing:ebanx_document_type\" class=\"required\">\n          Document Type\n      </label>\n      <div class=\"input-box\">\n          <select name=\"billing[ebanx_document_type]\" id=\"billing:ebanx_document_type\" title=\"Document Type\" class=\"validate-select required-entry\">\n            <option value=\"\">Select a document type</option>\n            <option value=\"ARG_CUIT\">CUIT</option>\n            <option value=\"ARG_CUIL\">CUIL</option>\n            <option value=\"ARG_CDI\">CDI</option>\n          </select>\n      </div>\n    </div>`;\n  const ul = taxVatInput.closest('ul');\n  ul.insertBefore(div, taxVatInput.closest('li'));\n};\n\nconst init = () => {\n  taxVatLabel= document.querySelector('label[for=\"billing\\\\:taxvat\"]');\n  taxVatInput = document.getElementById('billing:taxvat');\n  countrySelect = document.querySelector('#billing\\\\:country_id');\n\n  if (!EBANXData.maskTaxVat && !taxVatLabel && !taxVatInput && taxVatInput === null) {\n    return;\n  }\n\n  addDocumentTypeField();\n\n  if (!taxVatLabel && typeof amsCheckoutHandler === 'function') {\n    taxVatLabel = amsCheckoutHandler();\n  }\n\n  if (countrySelect) {\n    defaultLabel = taxVatLabel.innerHTML;\n\n    countrySelect.addEventListener('change', changeTaxVatLabel);\n    countrySelect.addEventListener('change', addDocumentTypeField);\n    countrySelect.addEventListener('change', removeDocumentTypeField);\n    countrySelect.dispatchEvent(new Event('change'));\n  }\n};\n\ndocument.addEventListener('DOMContentLoaded', init);\n"]}