{"version":3,"sources":["frontend/base/default/ebanx/js/document.js"],"names":["defaultLabel","taxVatLabel","taxVatInput","qs","document","querySelector","el","inputHandler","masks","max","event","c","target","v","value","replace","m","length","VMasker","unMask","maskPattern","toPattern","getLabelByCountry","country","toLowerCase","EBANXData","brazilAllowedDocumentFields","join","toUpperCase","changeTaxVatLabel","this","newLabel","OSCRequire","setTimeout","placeholder","innerHTML","taxVatMask","indexOf","addEventListener","bind","undefined","maskTaxVat","countrySelect","getElementById","amsCheckoutHandler","Event","dispatchEvent","ebanxRemoveOSCRequireDocument","init"],"mappings":"AAAA,aAEA,IAAIA,aACAC,YACAC,YAEAC,GAAK,SAALA,GACF,OAAOC,SAASC,cAAcC,IAGhC,SAASC,aAAaC,EAAOC,EAAKC,GAChC,IAAIC,EAAID,EAAME,OACVC,EAAIF,EAAEG,MAAMC,QAAQ,MAAO,IAC3BC,EAAIL,EAAEG,MAAMG,OAASR,EAAM,EAAI,EACnCS,QAAQP,GAAGQ,SACXD,QAAQP,GAAGS,YAAYZ,EAAMQ,IAC7BL,EAAEG,MAAQI,QAAQG,UAAUR,EAAGL,EAAMQ,IAGvC,IAAIM,kBAAoB,SAApBA,EAAAA,GACF,OAAQC,EAAQC,eACd,IAAK,KACH,OAAOC,UAAUC,4BAA4BC,KAAK,OAAOC,cAC3D,IAAK,KACH,MAAO,MACT,IAAK,KACH,MAAO,MACT,QACE,OAAO5B,IAIT6B,kBAAoB,WACtB,IAAIN,EAAUO,KAAKhB,MACfiB,EAAWT,kBAAkBC,EAASvB,cASzC,GAPDgC,WAAWT,GAEXU,WAAW,WAAA/B,YAAUgC,YAAA,IAAA,IAA+BjC,YAApDkC,UAAAJ,EAGe,OAAZR,GAAgC,OAAZA,GAAgC,OAAZA,GAD3CtB,WAAYkC,WAAYJ,YAAxBG,YAAAH,GAAA,IAE0B7B,QAAAA,aAAYgC,SACrC,OAAAX,EAAA,CAKC,IAAIa,GAA2C,IAA9BL,EAASM,QAAQ,SAAkB,iBAAkB,uBAAyB,iBAAkB,kBAHnHnB,QAAQhB,aAAaiB,YAArBiB,EAAA,IAKElC,YAAYoC,iBAAiB,QAAS/B,aAAagC,UAAKC,EAAWJ,EAAY,KAAK,KAApFlC,KAAAA,WACD,GAAAuB,UAAAgB,WAAA,CAID,IAAIC,EAAWD,GAAAA,yBACbxC,YAAAE,GAAA,iCACDD,YAAAE,SAAAuC,eAAA,kBAEGD,aAAJ,mBAAuBE,qBACvB3C,YAAcE,sBAGVF,aAAAyC,GAAuBE,cACzB3C,aAAc2C,YAAAA,UAMdF,EAAcJ,iBAAiB,SAAUT,mBAH3Ca,EAAIzC,cAAeyC,IAAfG,MAAgC3C,cAIlCwC,WAAAA,SAAcI,GACf,oBAAAC,+BAlBHA,8BAAAxB,IAuBIwB,SAAAA,iBAAAA,mBAAAC","file":"document.js","sourcesContent":["'use strict';\n\nvar defaultLabel;\nvar taxVatLabel;\nvar taxVatInput;\n\nvar qs = function (el) {\n  return document.querySelector(el);\n};\n\nfunction inputHandler(masks, max, event) {\n  var c = event.target;\n  var v = c.value.replace(/\\D/g, '');\n  var m = c.value.length > max ? 1 : 0;\n  VMasker(c).unMask();\n  VMasker(c).maskPattern(masks[m]);\n  c.value = VMasker.toPattern(v, masks[m]);\n}\n\nvar getLabelByCountry = function (country, defaultLabel) {\n  switch (country.toLowerCase()) {\n    case 'br':\n      return EBANXData.brazilAllowedDocumentFields.join(' / ').toUpperCase();\n    case 'co':\n      return 'DNI';\n    case 'cl':\n      return 'RUT';\n    default:\n      return defaultLabel;\n  }\n};\n\nvar changeTaxVatLabel = function () {\n  var country = this.value;\n  var newLabel = getLabelByCountry(country, defaultLabel);\n\n  OSCRequire(country);\n\n  setTimeout(function(){taxVatInput.placeholder = '';}, 10);\n\n  taxVatLabel.innerHTML = newLabel;\n  if(country === 'BR' || country === 'CO' || country === 'CL') {\n      setTimeout(function(){taxVatInput.placeholder = newLabel;}, 10)\n  }\n\n  VMasker(taxVatInput).unMask();\n\n  if (country === 'BR') {\n    var taxVatMask = newLabel.indexOf('CNPJ') !== -1 ? ['999.999.999-99', '99.999.999/9999-99'] : ['999.999.999-99', '999.999.999-99'];\n    VMasker(taxVatInput).maskPattern(taxVatMask[0]);\n    taxVatInput.addEventListener('input', inputHandler.bind(undefined, taxVatMask, 14), false);\n  }\n};\n\nvar init = function () {\n  if (!EBANXData.maskTaxVat) {\n    return;\n  }\n\n  var countrySelect = qs('#billing\\\\:country_id');\n  taxVatLabel = qs('label[for=\"billing\\\\:taxvat\"]');\n  taxVatInput = document.getElementById('billing:taxvat');\n\n  if (!taxVatLabel && typeof amsCheckoutHandler === 'function') {\n    taxVatLabel = amsCheckoutHandler();\n  }\n\n  if (taxVatLabel && countrySelect && taxVatInput) {\n    defaultLabel = taxVatLabel.innerHTML;\n\n    countrySelect.addEventListener('change', changeTaxVatLabel);\n    countrySelect.dispatchEvent(new Event('change'));\n  }\n};\n\nvar OSCRequire = function (country) {\n  if (typeof ebanxRemoveOSCRequireDocument !== 'undefined') {\n    ebanxRemoveOSCRequireDocument(country);\n  }\n};\n\ndocument.addEventListener('DOMContentLoaded', init);\n"]}