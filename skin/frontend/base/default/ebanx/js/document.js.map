{"version":3,"sources":["frontend/base/default/ebanx/js/document.js"],"names":["defaultLabel","taxVatLabel","taxVatInput","document","querySelector","el","inputHandler","masks","max","event","c","target","v","VMasker","value","m","toPattern","getLabelByCountry","country","toLowerCase","join","toUpperCase","EBANXData","OSCRequire","ebanxRemoveOSCRequireDocument","changeTaxVatLabel","undefined","newLabel","setTimeout","placeholder","unMask","taxVatMask","indexOf","init","maskTaxVat","addEventListener","bind","countrySelect","qs","dispatchEvent","Event","amsCheckoutHandler","innerHTML"],"mappings":"aAGA,IAAAA,kBAAAA,EAGIC,iBAAAA,EADAD,iBAAAA,EAEAE,GAAAA,SAAAA,GAGF,OAAOC,SAASC,cAAcC,IAC/B,SAFDC,aAAAC,EAAAC,EAAAC,GAKE,IAAMC,EAAID,EAAME,OADlBC,EAASN,EAAAA,MAAAA,QAAT,MAAkCG,IAC1BC,EAAID,EAAAA,MAAME,OAAhBH,EAAA,EAAA,EACAK,QAAUH,GAAEI,SACZD,QAAUH,GAAEI,YAAFP,EAAAQ,IACVF,EAAAA,MAAAA,QAAAG,UAAAJ,EAAAL,EAAAQ,IAGD,IAAAE,kBAAA,SAAAC,EAAAlB,GAGC,OAAQkB,EAAQC,eADZF,IAAAA,KACJ,OAAQC,UAAQC,4BAAhBC,KAAA,OAAAC,cACE,IAAK,KACH,MAAOC,MACT,IAAK,KACH,MAAO,MACT,QACE,OAAOtB,IAPbuB,WAAA,SAAAL,GAc+C,oBAAlCM,+BADPD,8BAAAA,IAANE,kBAAA,WAOE,IAAMP,QAAUQ,GAAKZ,MADjBW,EAAAA,kBAAAA,EAAAA,cAmCH,GAjCDF,WAAMI,GAENJ,WAGE,WADFK,YACEC,YAAW,IADb,IAQA5B,YAAIiB,UAAoBA,EAEpB,OADFU,GACQ,OAANV,GAAM,OAAAA,GACJhB,WAFJ,WAMDA,YAAA2B,YAAAF,GAEDd,IAMEA,QAAAA,aAAAiB,SAMD,OAAAZ,EAAA,CAnCH,IAAAa,GAAA,IAAAJ,EAAAK,QAAA,SA2BU,iBAAkB,uBAWtBC,iBAAa,kBACjBpB,QAAKS,aAAUY,YAAYH,EAAA,IACzB7B,YAAAiC,iBACD,QATG7B,aAAa8B,UAAKV,EAAWK,EAAY,KAWvCM,KAKJpC,KAAAA,WACD,GAAAqB,UAAAY,WAAA,CAND,IAAMG,EAAgBC,GAAG,yBAWvBD,YAAAA,GAAcF,iCACdE,YAAAA,SAAcE,eAAkBC,kBAjBpCvC,aAAA,mBAAAwC,qBAUIxC,YAAcwC,sBAGZxC,aAAeoC,GAAiBnC,cAClCF,aAAeC,YAAYyC,UAE3BL,EAAcF,iBAAiB,SAAUV,mBACzCY,EAAcE,cAAc,IAAIC,MAAM,cAI1CrC,SAASgC,iBAAiB,mBAAoBF","file":"document.js","sourcesContent":["/* global VMasker */\n/* global EBANXData */\n/* global amsCheckoutHandler */\n/* global ebanxRemoveOSCRequireDocument */\n\nlet defaultLabel;\nlet taxVatLabel;\nlet taxVatInput;\n\nconst qs = function(el) {\n  return document.querySelector(el);\n};\n\nfunction inputHandler(masks, max, event) {\n  const c = event.target;\n  const v = c.value.replace(/\\D/g, '');\n  const m = c.value.length > max ? 1 : 0;\n  VMasker(c).unMask();\n  VMasker(c).maskPattern(masks[m]);\n  c.value = VMasker.toPattern(v, masks[m]);\n}\n\nconst getLabelByCountry = (country, defaultLabel) => {\n  switch (country.toLowerCase()) {\n    case 'br':\n      return EBANXData.brazilAllowedDocumentFields.join(' / ').toUpperCase();\n    case 'co':\n      return 'DNI';\n    case 'cl':\n      return 'RUT';\n    default:\n      return defaultLabel;\n  }\n};\n\nconst OSCRequire = country => {\n  if (typeof ebanxRemoveOSCRequireDocument !== 'undefined') {\n    ebanxRemoveOSCRequireDocument(country);\n  }\n};\n\nconst changeTaxVatLabel = () => {\n  const country = this.value;\n  const newLabel = getLabelByCountry(country, defaultLabel);\n\n  OSCRequire(country);\n\n  setTimeout(\n    function() {\n      taxVatInput.placeholder = '';\n    },\n    10\n  );\n\n  taxVatLabel.innerHTML = newLabel;\n  if (country === 'BR' || country === 'CO' || country === 'CL') {\n    setTimeout(\n      () => {\n        taxVatInput.placeholder = newLabel;\n      },\n      10\n    );\n  }\n\n  VMasker(taxVatInput).unMask();\n\n  if (country === 'BR') {\n    const taxVatMask = newLabel.indexOf('CNPJ') !== -1\n      ? [ '999.999.999-99', '99.999.999/9999-99' ]\n      : [ '999.999.999-99', '999.999.999-99' ];\n    VMasker(taxVatInput).maskPattern(taxVatMask[0]);\n    taxVatInput.addEventListener(\n      'input',\n      inputHandler.bind(undefined, taxVatMask, 14),\n      false\n    );\n  }\n};\n\nconst init = () => {\n  if (!EBANXData.maskTaxVat) {\n    return;\n  }\n\n  const countrySelect = qs('#billing\\\\:country_id');\n  taxVatLabel = qs('label[for=\"billing\\\\:taxvat\"]');\n  taxVatInput = document.getElementById('billing:taxvat');\n\n  if (!taxVatLabel && typeof amsCheckoutHandler === 'function') {\n    taxVatLabel = amsCheckoutHandler();\n  }\n\n  if (taxVatLabel && countrySelect && taxVatInput) {\n    defaultLabel = taxVatLabel.innerHTML;\n\n    countrySelect.addEventListener('change', changeTaxVatLabel);\n    countrySelect.dispatchEvent(new Event('change'));\n  }\n};\n\ndocument.addEventListener('DOMContentLoaded', init);\n"]}